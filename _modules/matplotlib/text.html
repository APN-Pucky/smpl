

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>matplotlib.text &mdash; smpl  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> smpl
          

          
          </a>

          
            
            
              <div class="version">
                1.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Links:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/APN-Pucky/smpl">GitHub</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../example/index.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/smpl.html">smpl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Profiling:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../performance/index.html">Graph Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance/line.html">Line Profiling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://smpl.readthedocs.io/en/stable/">RTD</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apn-pucky.github.io/smpl/">Stable</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apn-pucky.github.io/smpl/test/">Dev</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">smpl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../matplotlib.html">matplotlib</a> &raquo;</li>
        
      <li>matplotlib.text</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for matplotlib.text</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Classes for including text in a figure.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="n">Real</span>
<span class="kn">import</span> <span class="nn">weakref</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">artist</span><span class="p">,</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">_docstring</span>
<span class="kn">from</span> <span class="nn">.artist</span> <span class="kn">import</span> <span class="n">Artist</span>
<span class="kn">from</span> <span class="nn">.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>
<span class="kn">from</span> <span class="nn">.patches</span> <span class="kn">import</span> <span class="n">FancyArrowPatch</span><span class="p">,</span> <span class="n">FancyBboxPatch</span><span class="p">,</span> <span class="n">Rectangle</span>
<span class="kn">from</span> <span class="nn">.textpath</span> <span class="kn">import</span> <span class="n">TextPath</span>  <span class="c1"># noqa # Unused, but imported by others.</span>
<span class="kn">from</span> <span class="nn">.transforms</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Affine2D</span><span class="p">,</span> <span class="n">Bbox</span><span class="p">,</span> <span class="n">BboxBase</span><span class="p">,</span> <span class="n">BboxTransformTo</span><span class="p">,</span> <span class="n">IdentityTransform</span><span class="p">,</span> <span class="n">Transform</span><span class="p">)</span>


<span class="n">_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="nd">@_api</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="s2">&quot;3.6&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_rotation</span><span class="p">(</span><span class="n">rotation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return *rotation* normalized to an angle between 0 and 360 degrees.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rotation : float or {None, &#39;horizontal&#39;, &#39;vertical&#39;}</span>
<span class="sd">        Rotation angle in degrees. *None* and &#39;horizontal&#39; equal 0,</span>
<span class="sd">        &#39;vertical&#39; equals 90.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_str_equal</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">rotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.</span>
        <span class="k">elif</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_str_equal</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;vertical&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="mf">90.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;rotation is </span><span class="si">{!r}</span><span class="s2">; expected either &#39;horizontal&#39;, &quot;</span>
                             <span class="s2">&quot;&#39;vertical&#39;, numeric value, or None&quot;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rotation</span><span class="p">))</span> <span class="kn">from</span> <span class="nn">err</span>


<span class="k">def</span> <span class="nf">_get_textbox</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the bounding box of the text.</span>

<span class="sd">    The bbox position takes text rotation into account, but the width and</span>
<span class="sd">    height are those of the unrotated box (unlike `.Text.get_window_extent`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO : This function may move into the Text class as a method. As a</span>
    <span class="c1"># matter of fact, the information from the _get_textbox function</span>
    <span class="c1"># should be available during the Text._get_layout() call, which is</span>
    <span class="c1"># called within the _get_textbox. So, it would better to move this</span>
    <span class="c1"># function as a method with some refactoring of _get_layout method.</span>

    <span class="n">projected_xs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">projected_ys</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">())</span>
    <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">parts</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">_get_layout</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">wh</span>

        <span class="n">xt1</span><span class="p">,</span> <span class="n">yt1</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">yt1</span> <span class="o">-=</span> <span class="n">d</span>
        <span class="n">xt2</span><span class="p">,</span> <span class="n">yt2</span> <span class="o">=</span> <span class="n">xt1</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">yt1</span> <span class="o">+</span> <span class="n">h</span>

        <span class="n">projected_xs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">xt1</span><span class="p">,</span> <span class="n">xt2</span><span class="p">])</span>
        <span class="n">projected_ys</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">yt1</span><span class="p">,</span> <span class="n">yt2</span><span class="p">])</span>

    <span class="n">xt_box</span><span class="p">,</span> <span class="n">yt_box</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">projected_xs</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">projected_ys</span><span class="p">)</span>
    <span class="n">w_box</span><span class="p">,</span> <span class="n">h_box</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">projected_xs</span><span class="p">)</span> <span class="o">-</span> <span class="n">xt_box</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">projected_ys</span><span class="p">)</span> <span class="o">-</span> <span class="n">yt_box</span>

    <span class="n">x_box</span><span class="p">,</span> <span class="n">y_box</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">xt_box</span><span class="p">,</span> <span class="n">yt_box</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">x_box</span><span class="p">,</span> <span class="n">y_box</span><span class="p">,</span> <span class="n">w_box</span><span class="p">,</span> <span class="n">h_box</span>


<span class="k">def</span> <span class="nf">_get_text_metrics_with_cache</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">fontprop</span><span class="p">,</span> <span class="n">ismath</span><span class="p">,</span> <span class="n">dpi</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call ``renderer.get_text_width_height_descent``, caching the results.&quot;&quot;&quot;</span>
    <span class="c1"># Cached based on a copy of fontprop so that later in-place mutations of</span>
    <span class="c1"># the passed-in argument do not mess up the cache.</span>
    <span class="k">return</span> <span class="n">_get_text_metrics_with_cache_impl</span><span class="p">(</span>
        <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">renderer</span><span class="p">),</span> <span class="n">text</span><span class="p">,</span> <span class="n">fontprop</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">ismath</span><span class="p">,</span> <span class="n">dpi</span><span class="p">)</span>


<span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_get_text_metrics_with_cache_impl</span><span class="p">(</span>
        <span class="n">renderer_ref</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">fontprop</span><span class="p">,</span> <span class="n">ismath</span><span class="p">,</span> <span class="n">dpi</span><span class="p">):</span>
    <span class="c1"># dpi is unused, but participates in cache invalidation (via the renderer).</span>
    <span class="k">return</span> <span class="n">renderer_ref</span><span class="p">()</span><span class="o">.</span><span class="n">get_text_width_height_descent</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fontprop</span><span class="p">,</span> <span class="n">ismath</span><span class="p">)</span>


<div class="viewcode-block" id="Text"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text">[docs]</a><span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
<span class="nd">@_api</span><span class="o">.</span><span class="n">define_aliases</span><span class="p">({</span>
    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontfamily&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;family&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontproperties&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="s2">&quot;font_properties&quot;</span><span class="p">],</span>
    <span class="s2">&quot;horizontalalignment&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ha&quot;</span><span class="p">],</span>
    <span class="s2">&quot;multialignment&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ma&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontname&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontstretch&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;stretch&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontstyle&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontvariant&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;variant&quot;</span><span class="p">],</span>
    <span class="s2">&quot;verticalalignment&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;va&quot;</span><span class="p">],</span>
    <span class="s2">&quot;fontweight&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">class</span> <span class="nc">Text</span><span class="p">(</span><span class="n">Artist</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Handle storing and drawing of text in window or data coordinates.&quot;&quot;&quot;</span>

    <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Text(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">))</span>

<div class="viewcode-block" id="Text.__init__"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.__init__">[docs]</a>    <span class="nd">@_api</span><span class="o">.</span><span class="n">make_keyword_only</span><span class="p">(</span><span class="s2">&quot;3.6&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>           <span class="c1"># defaults to rc params</span>
                 <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                 <span class="n">multialignment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">fontproperties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># defaults to FontProperties()</span>
                 <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">linespacing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">rotation_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">usetex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>          <span class="c1"># defaults to rcParams[&#39;text.usetex&#39;]</span>
                 <span class="n">wrap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">transform_rotates_text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="o">*</span><span class="p">,</span>
                 <span class="n">parse_math</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>    <span class="c1"># defaults to rcParams[&#39;text.parse_math&#39;]</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                 <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a `.Text` instance at *x*, *y* with string *text*.</span>

<span class="sd">        The text is aligned relative to the anchor point (*x*, *y*) according</span>
<span class="sd">        to ``horizontalalignment`` (default: &#39;left&#39;) and ``verticalalignment``</span>
<span class="sd">        (default: &#39;bottom&#39;). See also</span>
<span class="sd">        :doc:`/gallery/text_labels_and_annotations/text_alignment`.</span>

<span class="sd">        While Text accepts the &#39;label&#39; keyword argument, by default it is not</span>
<span class="sd">        added to the handles of a legend.</span>

<span class="sd">        Valid keyword arguments are:</span>

<span class="sd">        %(Text:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span>
            <span class="n">color</span> <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;text.color&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">fontproperties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_usetex</span><span class="p">(</span><span class="n">usetex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_parse_math</span><span class="p">(</span><span class="n">parse_math</span> <span class="k">if</span> <span class="n">parse_math</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span>
                            <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.parse_math&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_wrap</span><span class="p">(</span><span class="n">wrap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_verticalalignment</span><span class="p">(</span><span class="n">verticalalignment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_horizontalalignment</span><span class="p">(</span><span class="n">horizontalalignment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multialignment</span> <span class="o">=</span> <span class="n">multialignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transform_rotates_text</span> <span class="o">=</span> <span class="n">transform_rotates_text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># a FancyBboxPatch instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">linespacing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linespacing</span> <span class="o">=</span> <span class="mf">1.2</span>  <span class="c1"># Maybe use rcParam later.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_linespacing</span><span class="p">(</span><span class="n">linespacing</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_rotation_mode</span><span class="p">(</span><span class="n">rotation_mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Text.update"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">normalize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">Text</span><span class="p">)</span>
        <span class="n">sentinel</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>  <span class="c1"># bbox can be None, so use another sentinel.</span>
        <span class="c1"># Update fontproperties first, as it has lowest priority.</span>
        <span class="n">fontproperties</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;fontproperties&quot;</span><span class="p">,</span> <span class="n">sentinel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fontproperties</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">sentinel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_fontproperties</span><span class="p">(</span><span class="n">fontproperties</span><span class="p">)</span>
        <span class="c1"># Update bbox last, as it depends on font properties.</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bbox&quot;</span><span class="p">,</span> <span class="n">sentinel</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">sentinel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()</span>
        <span class="c1"># remove the cached _renderer (if it exists)</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;_renderer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">d</span>

<div class="viewcode-block" id="Text.contains"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.contains">[docs]</a>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the mouse event occurred inside the axis-aligned</span>
<span class="sd">        bounding-box of the text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inside</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_contains</span><span class="p">(</span><span class="n">mouseevent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inside</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inside</span><span class="p">,</span> <span class="n">info</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">{}</span>

        <span class="c1"># Explicitly use Text.get_window_extent(self) and not</span>
        <span class="c1"># self.get_window_extent() so that Annotation.contains does not</span>
        <span class="c1"># accidentally cover the entire annotation bounding box.</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span> <span class="o">&lt;=</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x1</span>
                  <span class="ow">and</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">&lt;=</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span>

        <span class="n">cattr</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># if the text has a surrounding patch, also check containment for it,</span>
        <span class="c1"># and merge the results with the results for the text.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">:</span>
            <span class="n">patch_inside</span><span class="p">,</span> <span class="n">patch_cattr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">mouseevent</span><span class="p">)</span>
            <span class="n">inside</span> <span class="o">=</span> <span class="n">inside</span> <span class="ow">or</span> <span class="n">patch_inside</span>
            <span class="n">cattr</span><span class="p">[</span><span class="s2">&quot;bbox_patch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">patch_cattr</span>

        <span class="k">return</span> <span class="n">inside</span><span class="p">,</span> <span class="n">cattr</span></div>

    <span class="k">def</span> <span class="nf">_get_xy_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the (possibly unit converted) transformed x, y in display coords.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unitless_position</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_multialignment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multialignment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multialignment</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span>

<div class="viewcode-block" id="Text.get_rotation"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_rotation">[docs]</a>    <span class="k">def</span> <span class="nf">get_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the text angle in degrees between 0 and 360.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform_rotates_text</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform_angles</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_unitless_position</span><span class="p">()])</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span></div>

<div class="viewcode-block" id="Text.get_transform_rotates_text"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_transform_rotates_text">[docs]</a>    <span class="k">def</span> <span class="nf">get_transform_rotates_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether rotations of the transform affect the text direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_rotates_text</span></div>

<div class="viewcode-block" id="Text.set_rotation_mode"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_rotation_mode">[docs]</a>    <span class="k">def</span> <span class="nf">set_rotation_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set text rotation mode.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        m : {None, &#39;default&#39;, &#39;anchor&#39;}</span>
<span class="sd">            If ``None`` or ``&quot;default&quot;``, the text will be first rotated, then</span>
<span class="sd">            aligned according to their horizontal and vertical alignments.  If</span>
<span class="sd">            ``&quot;anchor&quot;``, then alignment occurs before rotation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_api</span><span class="o">.</span><span class="n">check_in_list</span><span class="p">([</span><span class="s2">&quot;anchor&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rotation_mode</span> <span class="o">=</span> <span class="n">m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.get_rotation_mode"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_rotation_mode">[docs]</a>    <span class="k">def</span> <span class="nf">get_rotation_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the text rotation mode.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation_mode</span></div>

<div class="viewcode-block" id="Text.update_from"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.update_from">[docs]</a>    <span class="k">def</span> <span class="nf">update_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update_from</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_color</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multialignment</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_multialignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verticalalignment</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_verticalalignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_horizontalalignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_usetex</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_usetex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_rotation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transform_rotates_text</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_transform_rotates_text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_picker</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_picker</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_linespacing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">_get_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the extent (bbox) of the text together with</span>
<span class="sd">        multiple-alignment information. Note that it returns an extent</span>
<span class="sd">        of a rotated text when necessary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">thisx</span><span class="p">,</span> <span class="n">thisy</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Ensures lines is not empty.</span>

        <span class="n">ws</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">hs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Full vertical extent of font, including ascenders and descenders:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">lp_h</span><span class="p">,</span> <span class="n">lp_d</span> <span class="o">=</span> <span class="n">_get_text_metrics_with_cache</span><span class="p">(</span>
            <span class="n">renderer</span><span class="p">,</span> <span class="s2">&quot;lp&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="p">,</span>
            <span class="n">ismath</span><span class="o">=</span><span class="s2">&quot;TeX&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_usetex</span><span class="p">()</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">min_dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">lp_h</span> <span class="o">-</span> <span class="n">lp_d</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="n">clean_line</span><span class="p">,</span> <span class="n">ismath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess_math</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">clean_line</span><span class="p">:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">_get_text_metrics_with_cache</span><span class="p">(</span>
                    <span class="n">renderer</span><span class="p">,</span> <span class="n">clean_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="p">,</span>
                    <span class="n">ismath</span><span class="o">=</span><span class="n">ismath</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">h</span> <span class="o">=</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># For multiline text, increase the line spacing when the text</span>
            <span class="c1"># net-height (excluding baseline) is larger than that of a &quot;l&quot;</span>
            <span class="c1"># (e.g., use of superscripts), which seems what TeX does.</span>
            <span class="n">h</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">lp_h</span><span class="p">)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">lp_d</span><span class="p">)</span>

            <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
            <span class="n">hs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

            <span class="c1"># Metrics of the last line that are needed later:</span>
            <span class="n">baseline</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">-</span> <span class="n">thisy</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># position at baseline</span>
                <span class="n">thisy</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># put baseline a good distance from bottom of previous line</span>
                <span class="n">thisy</span> <span class="o">-=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_dy</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span><span class="p">)</span>

            <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisx</span><span class="p">)</span>  <span class="c1"># == 0.</span>
            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisy</span><span class="p">)</span>

            <span class="n">thisy</span> <span class="o">-=</span> <span class="n">d</span>

        <span class="c1"># Metrics of the last line that are needed later:</span>
        <span class="n">descent</span> <span class="o">=</span> <span class="n">d</span>

        <span class="c1"># Bounding box definition:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">width</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">descent</span>  <span class="c1"># baseline of last line minus its descent</span>

        <span class="c1"># get the rotation matrix</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">rotate_deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">())</span>

        <span class="c1"># now offset the individual text lines within the box</span>
        <span class="n">malign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_multialignment</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">malign</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
            <span class="n">offset_layout</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">malign</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
            <span class="n">offset_layout</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">ws</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">malign</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
            <span class="n">offset_layout</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">ws</span><span class="p">)]</span>

        <span class="c1"># the corners of the unrotated bounding box</span>
        <span class="n">corners_horiz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">),</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">)])</span>

        <span class="c1"># now rotate the bbox</span>
        <span class="n">corners_rotated</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">corners_horiz</span><span class="p">)</span>
        <span class="c1"># compute the bounds of the rotated box</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="n">corners_rotated</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">corners_rotated</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">corners_rotated</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="n">corners_rotated</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span>

        <span class="c1"># Now move the box to the target position offset the display</span>
        <span class="c1"># bbox by alignment</span>
        <span class="n">halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span>
        <span class="n">valign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verticalalignment</span>

        <span class="n">rotation_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotation_mode</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rotation_mode</span> <span class="o">!=</span> <span class="s2">&quot;anchor&quot;</span><span class="p">:</span>
            <span class="c1"># compute the text location in display coords and the offsets</span>
            <span class="c1"># necessary to align the bbox with that location</span>
            <span class="k">if</span> <span class="n">halign</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin</span> <span class="o">+</span> <span class="n">xmax</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">halign</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="n">xmax</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="n">xmin</span>

            <span class="k">if</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymin</span> <span class="o">+</span> <span class="n">ymax</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymax</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;baseline&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="n">descent</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;center_baseline&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="n">height</span> <span class="o">-</span> <span class="n">baseline</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymin</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xmin1</span><span class="p">,</span> <span class="n">ymin1</span> <span class="o">=</span> <span class="n">corners_horiz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">xmax1</span><span class="p">,</span> <span class="n">ymax1</span> <span class="o">=</span> <span class="n">corners_horiz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">halign</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin1</span> <span class="o">+</span> <span class="n">xmax1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="k">elif</span> <span class="n">halign</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="n">xmax1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offsetx</span> <span class="o">=</span> <span class="n">xmin1</span>

            <span class="k">if</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymin1</span> <span class="o">+</span> <span class="n">ymax1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymax1</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;baseline&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymax1</span> <span class="o">-</span> <span class="n">baseline</span>
            <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s1">&#39;center_baseline&#39;</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymax1</span> <span class="o">-</span> <span class="n">baseline</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offsety</span> <span class="o">=</span> <span class="n">ymin1</span>

            <span class="n">offsetx</span><span class="p">,</span> <span class="n">offsety</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">offsetx</span><span class="p">,</span> <span class="n">offsety</span><span class="p">))</span>

        <span class="n">xmin</span> <span class="o">-=</span> <span class="n">offsetx</span>
        <span class="n">ymin</span> <span class="o">-=</span> <span class="n">offsety</span>

        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

        <span class="c1"># now rotate the positions around the first (x, y) position</span>
        <span class="n">xys</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">offset_layout</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">offsetx</span><span class="p">,</span> <span class="n">offsety</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bbox</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">hs</span><span class="p">),</span> <span class="o">*</span><span class="n">xys</span><span class="o">.</span><span class="n">T</span><span class="p">)),</span> <span class="n">descent</span>

<div class="viewcode-block" id="Text.set_bbox"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_bbox">[docs]</a>    <span class="k">def</span> <span class="nf">set_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rectprops</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw a bounding box around self.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rectprops : dict with properties for `.patches.FancyBboxPatch`</span>
<span class="sd">             The default boxstyle is &#39;square&#39;. The mutation</span>
<span class="sd">             scale of the `.patches.FancyBboxPatch` is set to the fontsize.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            t.set_bbox(dict(facecolor=&#39;red&#39;, alpha=0.5))</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">rectprops</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">rectprops</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">boxstyle</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;boxstyle&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pad&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">boxstyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">boxstyle</span> <span class="o">=</span> <span class="s2">&quot;square&quot;</span>
                <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">pad</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># points</span>
                <span class="n">pad</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>  <span class="c1"># to fraction of font size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.3</span>
            <span class="c1"># boxstyle could be a callable or a string</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boxstyle</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;pad&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">boxstyle</span><span class="p">:</span>
                <span class="n">boxstyle</span> <span class="o">+=</span> <span class="s2">&quot;,pad=</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pad</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span> <span class="o">=</span> <span class="n">FancyBboxPatch</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">boxstyle</span><span class="o">=</span><span class="n">boxstyle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">IdentityTransform</span><span class="p">(),</span> <span class="o">**</span><span class="n">props</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_clip_properties</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_bbox_patch"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_bbox_patch">[docs]</a>    <span class="k">def</span> <span class="nf">get_bbox_patch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the bbox Patch, or None if the `.patches.FancyBboxPatch`</span>
<span class="sd">        is not made.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span></div>

<div class="viewcode-block" id="Text.update_bbox_position_size"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.update_bbox_position_size">[docs]</a>    <span class="k">def</span> <span class="nf">update_bbox_position_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the location and the size of the bbox.</span>

<span class="sd">        This method should be used when the position and size of the bbox needs</span>
<span class="sd">        to be updated before actually drawing the bbox.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">:</span>
            <span class="c1"># don&#39;t use self.get_unitless_position here, which refers to text</span>
            <span class="c1"># position in Text:</span>
            <span class="n">posx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))</span>
            <span class="n">posy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">))</span>
            <span class="n">posx</span><span class="p">,</span> <span class="n">posy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">posx</span><span class="p">,</span> <span class="n">posy</span><span class="p">))</span>

            <span class="n">x_box</span><span class="p">,</span> <span class="n">y_box</span><span class="p">,</span> <span class="n">w_box</span><span class="p">,</span> <span class="n">h_box</span> <span class="o">=</span> <span class="n">_get_textbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">w_box</span><span class="p">,</span> <span class="n">h_box</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span>
                <span class="n">Affine2D</span><span class="p">()</span>
                <span class="o">.</span><span class="n">rotate_deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">())</span>
                <span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">posx</span> <span class="o">+</span> <span class="n">x_box</span><span class="p">,</span> <span class="n">posy</span> <span class="o">+</span> <span class="n">y_box</span><span class="p">))</span>
            <span class="n">fontsize_in_pixel</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">set_mutation_scale</span><span class="p">(</span><span class="n">fontsize_in_pixel</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_update_clip_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">clipprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">clip_box</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">clipbox</span><span class="p">,</span>
                         <span class="n">clip_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_clippath</span><span class="p">,</span>
                         <span class="n">clip_on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_clipon</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">clipprops</span><span class="p">)</span>

<div class="viewcode-block" id="Text.set_clip_box"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_clip_box">[docs]</a>    <span class="k">def</span> <span class="nf">set_clip_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clipbox</span><span class="p">):</span>
        <span class="c1"># docstring inherited.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_clip_box</span><span class="p">(</span><span class="n">clipbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_clip_properties</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.set_clip_path"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_clip_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_clip_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># docstring inherited.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_clip_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_clip_properties</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.set_clip_on"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_clip_on">[docs]</a>    <span class="k">def</span> <span class="nf">set_clip_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="c1"># docstring inherited.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_clip_on</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_clip_properties</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_wrap"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_wrap">[docs]</a>    <span class="k">def</span> <span class="nf">get_wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether the text can be wrapped.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap</span></div>

<div class="viewcode-block" id="Text.set_wrap"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_wrap">[docs]</a>    <span class="k">def</span> <span class="nf">set_wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wrap</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether the text can be wrapped.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wrap : bool</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Wrapping does not work together with</span>
<span class="sd">        ``savefig(..., bbox_inches=&#39;tight&#39;)`` (which is also used internally</span>
<span class="sd">        by ``%matplotlib inline`` in IPython/Jupyter). The &#39;tight&#39; setting</span>
<span class="sd">        rescales the canvas to accommodate all content and happens before</span>
<span class="sd">        wrapping.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wrap</span> <span class="o">=</span> <span class="n">wrap</span></div>

    <span class="k">def</span> <span class="nf">_get_wrap_line_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the maximum line width for wrapping text based on the current</span>
<span class="sd">        orientation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_position</span><span class="p">())</span>
        <span class="n">figure_box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span>

        <span class="c1"># Calculate available width based on text alignment</span>
        <span class="n">alignment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_horizontalalignment</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_rotation_mode</span><span class="p">(</span><span class="s1">&#39;anchor&#39;</span><span class="p">)</span>
        <span class="n">rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">()</span>

        <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dist_to_box</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">figure_box</span><span class="p">)</span>
        <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dist_to_box</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">180</span> <span class="o">+</span> <span class="n">rotation</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">figure_box</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
            <span class="n">line_width</span> <span class="o">=</span> <span class="n">left</span>
        <span class="k">elif</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
            <span class="n">line_width</span> <span class="o">=</span> <span class="n">right</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">line_width</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">line_width</span>

    <span class="k">def</span> <span class="nf">_get_dist_to_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">figure_box</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the distance from the given points to the boundaries of a</span>
<span class="sd">        rotated box, in pixels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rotation</span> <span class="o">&gt;</span> <span class="mi">270</span><span class="p">:</span>
            <span class="n">quad</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">-</span> <span class="mi">270</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">quad</span><span class="p">))</span>
            <span class="n">h2</span> <span class="o">=</span> <span class="p">(</span><span class="n">figure_box</span><span class="o">.</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">quad</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">rotation</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
            <span class="n">quad</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">-</span> <span class="mi">180</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">quad</span><span class="p">))</span>
            <span class="n">h2</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">quad</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">rotation</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="n">quad</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">-</span> <span class="mi">90</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="p">(</span><span class="n">figure_box</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">quad</span><span class="p">))</span>
            <span class="n">h2</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">quad</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h1</span> <span class="o">=</span> <span class="p">(</span><span class="n">figure_box</span><span class="o">.</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">rotation</span><span class="p">))</span>
            <span class="n">h2</span> <span class="o">=</span> <span class="p">(</span><span class="n">figure_box</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">rotation</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_rendered_text_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the width of a given text string, in pixels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span><span class="o">.</span><span class="n">get_text_width_height_descent</span><span class="p">(</span>
            <span class="n">text</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_fontproperties</span><span class="p">(),</span>
            <span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_wrapped_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a copy of the text string with new lines added so that the text</span>
<span class="sd">        is wrapped relative to the parent figure (if `get_wrap` is True).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wrap</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>

        <span class="c1"># Not fit to handle breaking up latex syntax correctly, so</span>
        <span class="c1"># ignore latex for now.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_usetex</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>

        <span class="c1"># Build the line incrementally, for a more accurate measure of length</span>
        <span class="n">line_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_wrap_line_width</span><span class="p">()</span>
        <span class="n">wrapped_lines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># New lines in the user&#39;s text force a split</span>
        <span class="n">unwrapped_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Now wrap each individual unwrapped line</span>
        <span class="k">for</span> <span class="n">unwrapped_line</span> <span class="ow">in</span> <span class="n">unwrapped_lines</span><span class="p">:</span>

            <span class="n">sub_words</span> <span class="o">=</span> <span class="n">unwrapped_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="c1"># Remove items from sub_words as we go, so stop when empty</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_words</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># Only one word, so just add it to the end</span>
                    <span class="n">wrapped_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_words</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                    <span class="k">continue</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_words</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="c1"># Get width of all words up to and including here</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_words</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">current_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_rendered_text_width</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

                    <span class="c1"># If all these words are too wide, append all not including</span>
                    <span class="c1"># last word</span>
                    <span class="k">if</span> <span class="n">current_width</span> <span class="o">&gt;</span> <span class="n">line_width</span><span class="p">:</span>
                        <span class="n">wrapped_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_words</span><span class="p">[:</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>
                        <span class="n">sub_words</span> <span class="o">=</span> <span class="n">sub_words</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span>
                        <span class="k">break</span>

                    <span class="c1"># Otherwise if all words fit in the width, append them all</span>
                    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_words</span><span class="p">):</span>
                        <span class="n">wrapped_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_words</span><span class="p">[:</span><span class="n">i</span><span class="p">]))</span>
                        <span class="n">sub_words</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">break</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrapped_lines</span><span class="p">)</span>

<div class="viewcode-block" id="Text.draw"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.draw">[docs]</a>    <span class="nd">@artist</span><span class="o">.</span><span class="n">allow_rasterization</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>

        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="n">renderer</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">renderer</span><span class="o">.</span><span class="n">open_group</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gid</span><span class="p">())</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cm_set</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_wrapped_text</span><span class="p">()):</span>
            <span class="n">bbox</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">descent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_layout</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="n">trans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span>

            <span class="c1"># don&#39;t use self.get_position here, which refers to text</span>
            <span class="c1"># position in Text:</span>
            <span class="n">posx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))</span>
            <span class="n">posy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">))</span>
            <span class="n">posx</span><span class="p">,</span> <span class="n">posy</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">posx</span><span class="p">,</span> <span class="n">posy</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">posx</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">posy</span><span class="p">):</span>
                <span class="n">_log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;posx and posy should be finite values&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">canvasw</span><span class="p">,</span> <span class="n">canvash</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">get_canvas_width_height</span><span class="p">()</span>

            <span class="c1"># Update the location and size of the bbox</span>
            <span class="c1"># (`.patches.FancyBboxPatch`), and draw it.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_bbox_position_size</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

            <span class="n">gc</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">new_gc</span><span class="p">()</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">())</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">set_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_gc_clip</span><span class="p">(</span><span class="n">gc</span><span class="p">)</span>

            <span class="n">angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">info</span><span class="p">:</span>

                <span class="n">mtext</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">posx</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">posy</span>
                <span class="k">if</span> <span class="n">renderer</span><span class="o">.</span><span class="n">flipy</span><span class="p">():</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">canvash</span> <span class="o">-</span> <span class="n">y</span>
                <span class="n">clean_line</span><span class="p">,</span> <span class="n">ismath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess_math</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path_effects</span><span class="p">():</span>
                    <span class="kn">from</span> <span class="nn">matplotlib.patheffects</span> <span class="kn">import</span> <span class="n">PathEffectRenderer</span>
                    <span class="n">textrenderer</span> <span class="o">=</span> <span class="n">PathEffectRenderer</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_path_effects</span><span class="p">(),</span> <span class="n">renderer</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">textrenderer</span> <span class="o">=</span> <span class="n">renderer</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_usetex</span><span class="p">():</span>
                    <span class="n">textrenderer</span><span class="o">.</span><span class="n">draw_tex</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">clean_line</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span>
                                          <span class="n">mtext</span><span class="o">=</span><span class="n">mtext</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">textrenderer</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">clean_line</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span>
                                           <span class="n">ismath</span><span class="o">=</span><span class="n">ismath</span><span class="p">,</span> <span class="n">mtext</span><span class="o">=</span><span class="n">mtext</span><span class="p">)</span>

        <span class="n">gc</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
        <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Text.get_color"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_color">[docs]</a>    <span class="k">def</span> <span class="nf">get_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the color of the text.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_color</span></div>

<div class="viewcode-block" id="Text.get_fontproperties"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_fontproperties">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontproperties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the `.font_manager.FontProperties`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span></div>

<div class="viewcode-block" id="Text.get_fontfamily"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_fontfamily">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontfamily</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the list of font families used for font lookup.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_family</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_family</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_fontname"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_fontname">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font name as a string.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_fontstyle"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_fontstyle">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font style as a string.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_style</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_style</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_fontsize"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_fontsize">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font size as an integer.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_size_in_points</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_size_in_points</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_fontvariant"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_fontvariant">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontvariant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font variant as a string.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_variant</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_variant</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_fontweight"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_fontweight">[docs]</a>    <span class="k">def</span> <span class="nf">get_fontweight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font weight as a string or a number.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_weight</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_weight</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_stretch"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_stretch">[docs]</a>    <span class="k">def</span> <span class="nf">get_stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font stretch as a string or a number.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.get_stretch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_stretch</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.get_horizontalalignment"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_horizontalalignment">[docs]</a>    <span class="k">def</span> <span class="nf">get_horizontalalignment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the horizontal alignment as a string.  Will be one of</span>
<span class="sd">        &#39;left&#39;, &#39;center&#39; or &#39;right&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span></div>

<div class="viewcode-block" id="Text.get_unitless_position"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_unitless_position">[docs]</a>    <span class="k">def</span> <span class="nf">get_unitless_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the (x, y) unitless position of the text.&quot;&quot;&quot;</span>
        <span class="c1"># This will get the position with all unit information stripped away.</span>
        <span class="c1"># This is here for convenience since it is done in several locations.</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span></div>

<div class="viewcode-block" id="Text.get_position"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_position">[docs]</a>    <span class="k">def</span> <span class="nf">get_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the (x, y) position of the text.&quot;&quot;&quot;</span>
        <span class="c1"># This should return the same data (possible unitized) as was</span>
        <span class="c1"># specified with &#39;set_x&#39; and &#39;set_y&#39;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span></div>

    <span class="c1"># When removing, also remove the hash(color) check in set_color()</span>
<div class="viewcode-block" id="Text.get_prop_tup"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_prop_tup">[docs]</a>    <span class="nd">@_api</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="s2">&quot;3.5&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_prop_tup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a hashable tuple of properties.</span>

<span class="sd">        Not intended to be human readable, but useful for backends who</span>
<span class="sd">        want to cache derived information about text (e.g., layouts) and</span>
<span class="sd">        need to know if the text has changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unitless_position</span><span class="p">()</span>
        <span class="n">renderer</span> <span class="o">=</span> <span class="n">renderer</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_color</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_verticalalignment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span><span class="p">,</span>
                <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation_mode</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_transform_rotates_text</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span><span class="p">,</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">renderer</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="Text.get_text"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_text">[docs]</a>    <span class="k">def</span> <span class="nf">get_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the text string.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span></div>

<div class="viewcode-block" id="Text.get_verticalalignment"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_verticalalignment">[docs]</a>    <span class="k">def</span> <span class="nf">get_verticalalignment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the vertical alignment as a string.  Will be one of</span>
<span class="sd">        &#39;top&#39;, &#39;center&#39;, &#39;bottom&#39;, &#39;baseline&#39; or &#39;center_baseline&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verticalalignment</span></div>

<div class="viewcode-block" id="Text.get_window_extent"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_window_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the `.Bbox` bounding the text, in display units.</span>

<span class="sd">        In addition to being used internally, this is useful for specifying</span>
<span class="sd">        clickable regions in a png file on a web page.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        renderer : Renderer, optional</span>
<span class="sd">            A renderer is needed to compute the bounding box.  If the artist</span>
<span class="sd">            has already been drawn, the renderer is cached; thus, it is only</span>
<span class="sd">            necessary to pass this argument when calling `get_window_extent`</span>
<span class="sd">            before the first draw.  In practice, it is usually easier to</span>
<span class="sd">            trigger a draw first, e.g. by calling</span>
<span class="sd">            `~.Figure.draw_without_rendering` or ``plt.show()``.</span>

<span class="sd">        dpi : float, optional</span>
<span class="sd">            The dpi value for computing the bbox, defaults to</span>
<span class="sd">            ``self.figure.dpi`` (*not* the renderer dpi); should be set e.g. if</span>
<span class="sd">            to match regions with a figure saved with a custom dpi value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dpi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_setattr_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">):</span>
                <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_display</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="n">renderer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">_get_renderer</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot get window extent of text w/o renderer. You likely &quot;</span>
                <span class="s2">&quot;want to call &#39;figure.draw_without_rendering()&#39; first.&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_setattr_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">):</span>
            <span class="n">bbox</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">descent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_layout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unitless_position</span><span class="p">()</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">translated</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bbox</span></div>

<div class="viewcode-block" id="Text.set_backgroundcolor"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_backgroundcolor">[docs]</a>    <span class="k">def</span> <span class="nf">set_backgroundcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the background color of the text by updating the bbox.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color : color</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .set_bbox : To change the position of the bounding box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_bbox</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_clip_properties</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_color"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_color">[docs]</a>    <span class="k">def</span> <span class="nf">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the foreground color of the text</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color : color</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># &quot;auto&quot; is only supported by axisartist, but we can just let it error</span>
        <span class="c1"># out at draw time for simplicity.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_str_equal</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">):</span>
            <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">_check_color_like</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="c1"># Make sure it is hashable, or get_prop_tup will fail (remove this once</span>
        <span class="c1"># get_prop_tup is removed).</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">hash</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_color</span> <span class="o">=</span> <span class="n">color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_horizontalalignment"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_horizontalalignment">[docs]</a>    <span class="k">def</span> <span class="nf">set_horizontalalignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">align</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the horizontal alignment relative to the anchor point.</span>

<span class="sd">        See also :doc:`/gallery/text_labels_and_annotations/text_alignment`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        align : {&#39;left&#39;, &#39;center&#39;, &#39;right&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_api</span><span class="o">.</span><span class="n">check_in_list</span><span class="p">([</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_horizontalalignment</span> <span class="o">=</span> <span class="n">align</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_multialignment"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_multialignment">[docs]</a>    <span class="k">def</span> <span class="nf">set_multialignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">align</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the text alignment for multiline texts.</span>

<span class="sd">        The layout of the bounding box of all the lines is determined by the</span>
<span class="sd">        horizontalalignment and verticalalignment properties. This property</span>
<span class="sd">        controls the alignment of the text lines within that box.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        align : {&#39;left&#39;, &#39;right&#39;, &#39;center&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_api</span><span class="o">.</span><span class="n">check_in_list</span><span class="p">([</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multialignment</span> <span class="o">=</span> <span class="n">align</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_linespacing"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_linespacing">[docs]</a>    <span class="k">def</span> <span class="nf">set_linespacing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spacing</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the line spacing as a multiple of the font size.</span>

<span class="sd">        The default line spacing is 1.2.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        spacing : float (multiple of font size)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_api</span><span class="o">.</span><span class="n">check_isinstance</span><span class="p">(</span><span class="n">Real</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linespacing</span> <span class="o">=</span> <span class="n">spacing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontfamily"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_fontfamily">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontfamily</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fontname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font family.  May be either a single string, or a list of</span>
<span class="sd">        strings in decreasing priority.  Each string may be either a real font</span>
<span class="sd">        name or a generic font class name.  If the latter, the specific font</span>
<span class="sd">        names will be looked up in the corresponding rcParams.</span>

<span class="sd">        If a `Text` instance is constructed with ``fontfamily=None``, then the</span>
<span class="sd">        font is set to :rc:`font.family`, and the</span>
<span class="sd">        same is done when `set_fontfamily()` is called on an existing</span>
<span class="sd">        `Text` instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fontname : {FONTNAME, &#39;serif&#39;, &#39;sans-serif&#39;, &#39;cursive&#39;, &#39;fantasy&#39;, \</span>
<span class="sd">&#39;monospace&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_family</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_family</span><span class="p">(</span><span class="n">fontname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontvariant"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_fontvariant">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontvariant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variant</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font variant.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variant : {&#39;normal&#39;, &#39;small-caps&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_variant</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_variant</span><span class="p">(</span><span class="n">variant</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontstyle"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_fontstyle">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fontstyle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font style.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fontstyle : {&#39;normal&#39;, &#39;italic&#39;, &#39;oblique&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_style</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">fontstyle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontsize"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_fontsize">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font size.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fontsize : float or {&#39;xx-small&#39;, &#39;x-small&#39;, &#39;small&#39;, &#39;medium&#39;, \</span>
<span class="sd">&#39;large&#39;, &#39;x-large&#39;, &#39;xx-large&#39;}</span>
<span class="sd">            If float, the fontsize in points. The string values denote sizes</span>
<span class="sd">            relative to the default font size.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_size</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.get_math_fontfamily"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_math_fontfamily">[docs]</a>    <span class="k">def</span> <span class="nf">get_math_fontfamily</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the font family name for math text rendered by Matplotlib.</span>

<span class="sd">        The default value is :rc:`mathtext.fontset`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        set_math_fontfamily</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">get_math_fontfamily</span><span class="p">()</span></div>

<div class="viewcode-block" id="Text.set_math_fontfamily"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_math_fontfamily">[docs]</a>    <span class="k">def</span> <span class="nf">set_math_fontfamily</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fontfamily</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font family for math text rendered by Matplotlib.</span>

<span class="sd">        This does only affect Matplotlib&#39;s own math renderer. It has no effect</span>
<span class="sd">        when rendering with TeX (``usetex=True``).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fontfamily : str</span>
<span class="sd">            The name of the font family.</span>

<span class="sd">            Available font families are defined in the</span>
<span class="sd">            :ref:`matplotlibrc.template file</span>
<span class="sd">            &lt;customizing-with-matplotlibrc-files&gt;`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        get_math_fontfamily</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_math_fontfamily</span><span class="p">(</span><span class="n">fontfamily</span><span class="p">)</span></div>

<div class="viewcode-block" id="Text.set_fontweight"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_fontweight">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontweight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weight</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font weight.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        weight : {a numeric value in range 0-1000, &#39;ultralight&#39;, &#39;light&#39;, \</span>
<span class="sd">&#39;normal&#39;, &#39;regular&#39;, &#39;book&#39;, &#39;medium&#39;, &#39;roman&#39;, &#39;semibold&#39;, &#39;demibold&#39;, \</span>
<span class="sd">&#39;demi&#39;, &#39;bold&#39;, &#39;heavy&#39;, &#39;extra bold&#39;, &#39;black&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_weight</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_fontstretch"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_fontstretch">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontstretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stretch</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font stretch (horizontal condensation or expansion).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stretch : {a numeric value in range 0-1000, &#39;ultra-condensed&#39;, \</span>
<span class="sd">&#39;extra-condensed&#39;, &#39;condensed&#39;, &#39;semi-condensed&#39;, &#39;normal&#39;, &#39;semi-expanded&#39;, \</span>
<span class="sd">&#39;expanded&#39;, &#39;extra-expanded&#39;, &#39;ultra-expanded&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_stretch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span><span class="o">.</span><span class="n">set_stretch</span><span class="p">(</span><span class="n">stretch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_position"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_position">[docs]</a>    <span class="k">def</span> <span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the (*x*, *y*) position of the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="Text.set_x"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_x">[docs]</a>    <span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the *x* position of the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_y"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_y">[docs]</a>    <span class="k">def</span> <span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the *y* position of the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        y : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_rotation"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_rotation">[docs]</a>    <span class="k">def</span> <span class="nf">set_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the rotation of the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : float or {&#39;vertical&#39;, &#39;horizontal&#39;}</span>
<span class="sd">            The rotation angle in degrees in mathematically positive direction</span>
<span class="sd">            (counterclockwise). &#39;horizontal&#39; equals 0, &#39;vertical&#39; equals 90.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Real</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="k">elif</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_str_equal</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">elif</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_str_equal</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;vertical&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="mf">90.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;rotation must be &#39;vertical&#39;, &#39;horizontal&#39; or &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;a number, not </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_transform_rotates_text"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_transform_rotates_text">[docs]</a>    <span class="k">def</span> <span class="nf">set_transform_rotates_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether rotations of the transform affect the text direction.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transform_rotates_text</span> <span class="o">=</span> <span class="n">t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_verticalalignment"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_verticalalignment">[docs]</a>    <span class="k">def</span> <span class="nf">set_verticalalignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">align</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the vertical alignment relative to the anchor point.</span>

<span class="sd">        See also :doc:`/gallery/text_labels_and_annotations/text_alignment`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        align : {&#39;bottom&#39;, &#39;baseline&#39;, &#39;center&#39;, &#39;center_baseline&#39;, &#39;top&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_api</span><span class="o">.</span><span class="n">check_in_list</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;center_baseline&#39;</span><span class="p">],</span>
            <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verticalalignment</span> <span class="o">=</span> <span class="n">align</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_text"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_text">[docs]</a>    <span class="k">def</span> <span class="nf">set_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the text string *s*.</span>

<span class="sd">        It may contain newlines (``\n``) or math in LaTeX syntax.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : object</span>
<span class="sd">            Any object gets converted to its `str` representation, except for</span>
<span class="sd">            ``None`` which is converted to an empty string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">_preprocess_math</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the string *s* after mathtext preprocessing, and the kind of</span>
<span class="sd">        mathtext support needed.</span>

<span class="sd">        - If *self* is configured to use TeX, return *s* unchanged except that</span>
<span class="sd">          a single space gets escaped, and the flag &quot;TeX&quot;.</span>
<span class="sd">        - Otherwise, if *s* is mathtext (has an even number of unescaped dollar</span>
<span class="sd">          signs) and ``parse_math`` is not set to False, return *s* and the</span>
<span class="sd">          flag True.</span>
<span class="sd">        - Otherwise, return *s* with dollar signs unescaped, and the flag</span>
<span class="sd">          False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_usetex</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\ &quot;</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;TeX&quot;</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parse_math</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">cbook</span><span class="o">.</span><span class="n">is_math_text</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\$&quot;</span><span class="p">,</span> <span class="s2">&quot;$&quot;</span><span class="p">),</span> <span class="kc">False</span>

<div class="viewcode-block" id="Text.set_fontproperties"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_fontproperties">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontproperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the font properties that control the text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fp : `.font_manager.FontProperties` or `str` or `pathlib.Path`</span>
<span class="sd">            If a `str`, it is interpreted as a fontconfig pattern parsed by</span>
<span class="sd">            `.FontProperties`.  If a `pathlib.Path`, it is interpreted as the</span>
<span class="sd">            absolute path to a font file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fontproperties</span> <span class="o">=</span> <span class="n">FontProperties</span><span class="o">.</span><span class="n">_from_any</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.set_usetex"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_usetex">[docs]</a>    <span class="k">def</span> <span class="nf">set_usetex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usetex</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        usetex : bool or None</span>
<span class="sd">            Whether to render using TeX, ``None`` means to use</span>
<span class="sd">            :rc:`text.usetex`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">usetex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_usetex</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_usetex</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">usetex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Text.get_usetex"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_usetex">[docs]</a>    <span class="k">def</span> <span class="nf">get_usetex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether this `Text` object uses TeX for rendering.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_usetex</span></div>

<div class="viewcode-block" id="Text.set_parse_math"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_parse_math">[docs]</a>    <span class="k">def</span> <span class="nf">set_parse_math</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse_math</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override switch to disable any mathtext parsing for this `Text`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parse_math : bool</span>
<span class="sd">            If False, this `Text` will never use mathtext.  If True, mathtext</span>
<span class="sd">            will be used if there is an even number of unescaped dollar signs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_math</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">parse_math</span><span class="p">)</span></div>

<div class="viewcode-block" id="Text.get_parse_math"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.get_parse_math">[docs]</a>    <span class="k">def</span> <span class="nf">get_parse_math</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether mathtext parsing is considered for this `Text`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_math</span></div>

<div class="viewcode-block" id="Text.set_fontname"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Text.html#smpl.plot.Text.set_fontname">[docs]</a>    <span class="k">def</span> <span class="nf">set_fontname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fontname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Alias for `set_family`.</span>

<span class="sd">        One-way alias only: the getter differs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fontname : {FONTNAME, &#39;serif&#39;, &#39;sans-serif&#39;, &#39;cursive&#39;, &#39;fantasy&#39;, \</span>
<span class="sd">&#39;monospace&#39;}</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .font_manager.FontProperties.set_family</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_family</span><span class="p">(</span><span class="n">fontname</span><span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">OffsetFrom</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Callable helper class for working with `Annotation`.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artist</span><span class="p">,</span> <span class="n">ref_coord</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;points&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        artist : `.Artist` or `.BboxBase` or `.Transform`</span>
<span class="sd">            The object to compute the offset from.</span>

<span class="sd">        ref_coord : (float, float)</span>
<span class="sd">            If *artist* is an `.Artist` or `.BboxBase`, this values is</span>
<span class="sd">            the location to of the offset origin in fractions of the</span>
<span class="sd">            *artist* bounding box.</span>

<span class="sd">            If *artist* is a transform, the offset origin is the</span>
<span class="sd">            transform applied to this value.</span>

<span class="sd">        unit : {&#39;points, &#39;pixels&#39;}, default: &#39;points&#39;</span>
<span class="sd">            The screen units to use (pixels or points) for the offset input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_artist</span> <span class="o">=</span> <span class="n">artist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ref_coord</span> <span class="o">=</span> <span class="n">ref_coord</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_unit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the unit for input to the transform used by ``__call__``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        unit : {&#39;points&#39;, &#39;pixels&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_api</span><span class="o">.</span><span class="n">check_in_list</span><span class="p">([</span><span class="s2">&quot;points&quot;</span><span class="p">,</span> <span class="s2">&quot;pixels&quot;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span> <span class="o">=</span> <span class="n">unit</span>

    <span class="k">def</span> <span class="nf">get_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the unit for input to the transform used by ``__call__``.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span>

    <span class="k">def</span> <span class="nf">_get_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unit</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;pixels&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">1.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the offset transform.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        renderer : `RendererBase`</span>
<span class="sd">            The renderer to use to compute the offset</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `Transform`</span>
<span class="sd">            Maps (x, y) in pixel or point units to screen units</span>
<span class="sd">            relative to the given artist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="p">,</span> <span class="n">Artist</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="n">xf</span><span class="p">,</span> <span class="n">yf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_coord</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">xf</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">yf</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="p">,</span> <span class="n">BboxBase</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_artist</span>
            <span class="n">xf</span><span class="p">,</span> <span class="n">yf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_coord</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">xf</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">yf</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_artist</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ref_coord</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;unknown type&quot;</span><span class="p">)</span>

        <span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scale</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tr</span>


<span class="k">class</span> <span class="nc">_AnnotationBase</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">xy</span><span class="p">,</span>
                 <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                 <span class="n">annotation_clip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xy</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span> <span class="o">=</span> <span class="n">xycoords</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_annotation_clip</span><span class="p">(</span><span class="n">annotation_clip</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span>
        <span class="k">if</span> <span class="n">s1</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">s2</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_transform</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_xy_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s</span>
            <span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">blended_transform_factory</span>
            <span class="n">tr1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_transform</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
            <span class="n">tr2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_transform</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">blended_transform_factory</span><span class="p">(</span><span class="n">tr1</span><span class="p">,</span> <span class="n">tr2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tr</span>
        <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">BboxBase</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">BboxTransformTo</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">tr</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unknown return type&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Artist</span><span class="p">):</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">BboxTransformTo</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">BboxBase</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">BboxTransformTo</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown coordinate type: </span><span class="si">{</span><span class="n">s</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;polar&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">matplotlib.projections</span> <span class="kn">import</span> <span class="n">PolarAxes</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">PolarAxes</span><span class="o">.</span><span class="n">PolarTransform</span><span class="p">()</span>
            <span class="n">trans</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transData</span>
            <span class="k">return</span> <span class="n">trans</span>

        <span class="n">s_</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">!r}</span><span class="s2"> is not a recognized coordinate&quot;</span><span class="p">)</span>

        <span class="n">bbox0</span><span class="p">,</span> <span class="n">xy0</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">bbox_name</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">s_</span>
        <span class="c1"># if unit is offset-like</span>
        <span class="k">if</span> <span class="n">bbox_name</span> <span class="o">==</span> <span class="s2">&quot;figure&quot;</span><span class="p">:</span>
            <span class="n">bbox0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">figbbox</span>
        <span class="k">elif</span> <span class="n">bbox_name</span> <span class="o">==</span> <span class="s2">&quot;subfigure&quot;</span><span class="p">:</span>
            <span class="n">bbox0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">bbox</span>
        <span class="k">elif</span> <span class="n">bbox_name</span> <span class="o">==</span> <span class="s2">&quot;axes&quot;</span><span class="p">:</span>
            <span class="n">bbox0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">bbox</span>
        <span class="c1"># elif bbox_name == &quot;bbox&quot;:</span>
        <span class="c1">#     if bbox is None:</span>
        <span class="c1">#         raise RuntimeError(&quot;bbox is specified as a coordinate but &quot;</span>
        <span class="c1">#                            &quot;never set&quot;)</span>
        <span class="c1">#     bbox0 = self._get_bbox(renderer, bbox)</span>

        <span class="k">if</span> <span class="n">bbox0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xy0</span> <span class="o">=</span> <span class="n">bbox0</span><span class="o">.</span><span class="n">p0</span>
        <span class="k">elif</span> <span class="n">bbox_name</span> <span class="o">==</span> <span class="s2">&quot;offset&quot;</span><span class="p">:</span>
            <span class="n">xy0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ref_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xy0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># reference x, y in display coordinate</span>
            <span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span> <span class="o">=</span> <span class="n">xy0</span>
            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;points&quot;</span><span class="p">:</span>
                <span class="c1"># dots per points</span>
                <span class="n">dpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span> <span class="o">/</span> <span class="mi">72</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">dpp</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;pixels&quot;</span><span class="p">:</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;fontsize&quot;</span><span class="p">:</span>
                <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
                <span class="n">dpp</span> <span class="o">=</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span> <span class="o">/</span> <span class="mi">72</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">dpp</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;fraction&quot;</span><span class="p">:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">bbox0</span><span class="o">.</span><span class="n">size</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unit</span><span class="si">!r}</span><span class="s2"> is not a recognized unit&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">tr</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">!r}</span><span class="s2"> is not a recognized coordinate&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_ref_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return x, y (in display coordinates) that is to be used for a reference</span>
<span class="sd">        of any offset coordinate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span><span class="p">)</span>

    <span class="c1"># def _get_bbox(self, renderer):</span>
    <span class="c1">#     if hasattr(bbox, &quot;bounds&quot;):</span>
    <span class="c1">#         return bbox</span>
    <span class="c1">#     elif hasattr(bbox, &quot;get_window_extent&quot;):</span>
    <span class="c1">#         bbox = bbox.get_window_extent()</span>
    <span class="c1">#         return bbox</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         raise ValueError(&quot;A bbox instance is expected but got %s&quot; %</span>
    <span class="c1">#                          str(bbox))</span>

    <span class="k">def</span> <span class="nf">set_annotation_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the annotation&#39;s clipping behavior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : bool or None</span>
<span class="sd">            - True: The annotation will be clipped when ``self.xy`` is</span>
<span class="sd">              outside the axes.</span>
<span class="sd">            - False: The annotation will always be drawn.</span>
<span class="sd">            - None: The annotation will be clipped when ``self.xy`` is</span>
<span class="sd">              outside the axes and ``self.xycoords == &quot;data&quot;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_annotation_clip</span> <span class="o">=</span> <span class="n">b</span>

    <span class="k">def</span> <span class="nf">get_annotation_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the annotation&#39;s clipping behavior.</span>

<span class="sd">        See `set_annotation_clip` for the meaning of return values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_annotation_clip</span>

    <span class="k">def</span> <span class="nf">_get_position_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the pixel position of the annotated point.&quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check whether the annotation at *xy_pixel* should be drawn.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">renderer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">_get_renderer</span><span class="p">()</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_annotation_clip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">b</span> <span class="ow">or</span> <span class="p">(</span><span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span> <span class="o">==</span> <span class="s2">&quot;data&quot;</span><span class="p">):</span>
            <span class="c1"># check if self.xy is inside the axes.</span>
            <span class="n">xy_pixel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_position_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">contains_point</span><span class="p">(</span><span class="n">xy_pixel</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">draggable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_blit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether the annotation is draggable with the mouse.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state : bool or None</span>
<span class="sd">            - True or False: set the draggability.</span>
<span class="sd">            - None: toggle the draggability.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DraggableAnnotation or None</span>
<span class="sd">            If the annotation is draggable, the corresponding</span>
<span class="sd">            `.DraggableAnnotation` helper is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">matplotlib.offsetbox</span> <span class="kn">import</span> <span class="n">DraggableAnnotation</span>
        <span class="n">is_draggable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="c1"># if state is None we&#39;ll toggle</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">is_draggable</span>

        <span class="k">if</span> <span class="n">state</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="o">=</span> <span class="n">DraggableAnnotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_blit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span>


<div class="viewcode-block" id="Annotation"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Annotation.html#smpl.plot.Annotation">[docs]</a><span class="k">class</span> <span class="nc">Annotation</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="n">_AnnotationBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An `.Annotation` is a `.Text` that can refer to a specific position *xy*.</span>
<span class="sd">    Optionally an arrow pointing from the text to *xy* can be drawn.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    xy</span>
<span class="sd">        The annotated position.</span>
<span class="sd">    xycoords</span>
<span class="sd">        The coordinate system for *xy*.</span>
<span class="sd">    arrow_patch</span>
<span class="sd">        A `.FancyArrowPatch` to point from *xytext* to *xy*.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Annotation(</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">, </span><span class="si">%r</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span><span class="p">)</span>

<div class="viewcode-block" id="Annotation.__init__"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Annotation.html#smpl.plot.Annotation.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span>
                 <span class="n">xytext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                 <span class="n">textcoords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">arrowprops</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">annotation_clip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Annotate the point *xy* with text *text*.</span>

<span class="sd">        In the simplest form, the text is placed at *xy*.</span>

<span class="sd">        Optionally, the text can be displayed in another position *xytext*.</span>
<span class="sd">        An arrow pointing from the text to the annotated point *xy* can then</span>
<span class="sd">        be added by defining *arrowprops*.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : str</span>
<span class="sd">            The text of the annotation.</span>

<span class="sd">        xy : (float, float)</span>
<span class="sd">            The point *(x, y)* to annotate. The coordinate system is determined</span>
<span class="sd">            by *xycoords*.</span>

<span class="sd">        xytext : (float, float), default: *xy*</span>
<span class="sd">            The position *(x, y)* to place the text at. The coordinate system</span>
<span class="sd">            is determined by *textcoords*.</span>

<span class="sd">        xycoords : str or `.Artist` or `.Transform` or callable or \</span>
<span class="sd">(float, float), default: &#39;data&#39;</span>

<span class="sd">            The coordinate system that *xy* is given in. The following types</span>
<span class="sd">            of values are supported:</span>

<span class="sd">            - One of the following strings:</span>

<span class="sd">              ==================== ============================================</span>
<span class="sd">              Value                Description</span>
<span class="sd">              ==================== ============================================</span>
<span class="sd">              &#39;figure points&#39;      Points from the lower left of the figure</span>
<span class="sd">              &#39;figure pixels&#39;      Pixels from the lower left of the figure</span>
<span class="sd">              &#39;figure fraction&#39;    Fraction of figure from lower left</span>
<span class="sd">              &#39;subfigure points&#39;   Points from the lower left of the subfigure</span>
<span class="sd">              &#39;subfigure pixels&#39;   Pixels from the lower left of the subfigure</span>
<span class="sd">              &#39;subfigure fraction&#39; Fraction of subfigure from lower left</span>
<span class="sd">              &#39;axes points&#39;        Points from lower left corner of axes</span>
<span class="sd">              &#39;axes pixels&#39;        Pixels from lower left corner of axes</span>
<span class="sd">              &#39;axes fraction&#39;      Fraction of axes from lower left</span>
<span class="sd">              &#39;data&#39;               Use the coordinate system of the object</span>
<span class="sd">                                   being annotated (default)</span>
<span class="sd">              &#39;polar&#39;              *(theta, r)* if not native &#39;data&#39;</span>
<span class="sd">                                   coordinates</span>
<span class="sd">              ==================== ============================================</span>

<span class="sd">              Note that &#39;subfigure pixels&#39; and &#39;figure pixels&#39; are the same</span>
<span class="sd">              for the parent figure, so users who want code that is usable in</span>
<span class="sd">              a subfigure can use &#39;subfigure pixels&#39;.</span>

<span class="sd">            - An `.Artist`: *xy* is interpreted as a fraction of the artist&#39;s</span>
<span class="sd">              `~matplotlib.transforms.Bbox`. E.g. *(0, 0)* would be the lower</span>
<span class="sd">              left corner of the bounding box and *(0.5, 1)* would be the</span>
<span class="sd">              center top of the bounding box.</span>

<span class="sd">            - A `.Transform` to transform *xy* to screen coordinates.</span>

<span class="sd">            - A function with one of the following signatures::</span>

<span class="sd">                def transform(renderer) -&gt; Bbox</span>
<span class="sd">                def transform(renderer) -&gt; Transform</span>

<span class="sd">              where *renderer* is a `.RendererBase` subclass.</span>

<span class="sd">              The result of the function is interpreted like the `.Artist` and</span>
<span class="sd">              `.Transform` cases above.</span>

<span class="sd">            - A tuple *(xcoords, ycoords)* specifying separate coordinate</span>
<span class="sd">              systems for *x* and *y*. *xcoords* and *ycoords* must each be</span>
<span class="sd">              of one of the above described types.</span>

<span class="sd">            See :ref:`plotting-guide-annotation` for more details.</span>

<span class="sd">        textcoords : str or `.Artist` or `.Transform` or callable or \</span>
<span class="sd">(float, float), default: value of *xycoords*</span>
<span class="sd">            The coordinate system that *xytext* is given in.</span>

<span class="sd">            All *xycoords* values are valid as well as the following</span>
<span class="sd">            strings:</span>

<span class="sd">            =================   =========================================</span>
<span class="sd">            Value               Description</span>
<span class="sd">            =================   =========================================</span>
<span class="sd">            &#39;offset points&#39;     Offset (in points) from the *xy* value</span>
<span class="sd">            &#39;offset pixels&#39;     Offset (in pixels) from the *xy* value</span>
<span class="sd">            =================   =========================================</span>

<span class="sd">        arrowprops : dict, optional</span>
<span class="sd">            The properties used to draw a `.FancyArrowPatch` arrow between the</span>
<span class="sd">            positions *xy* and *xytext*.  Defaults to None, i.e. no arrow is</span>
<span class="sd">            drawn.</span>

<span class="sd">            For historical reasons there are two different ways to specify</span>
<span class="sd">            arrows, &quot;simple&quot; and &quot;fancy&quot;:</span>

<span class="sd">            **Simple arrow:**</span>

<span class="sd">            If *arrowprops* does not contain the key &#39;arrowstyle&#39; the</span>
<span class="sd">            allowed keys are:</span>

<span class="sd">            ==========   ======================================================</span>
<span class="sd">            Key          Description</span>
<span class="sd">            ==========   ======================================================</span>
<span class="sd">            width        The width of the arrow in points</span>
<span class="sd">            headwidth    The width of the base of the arrow head in points</span>
<span class="sd">            headlength   The length of the arrow head in points</span>
<span class="sd">            shrink       Fraction of total length to shrink from both ends</span>
<span class="sd">            ?            Any key to :class:`matplotlib.patches.FancyArrowPatch`</span>
<span class="sd">            ==========   ======================================================</span>

<span class="sd">            The arrow is attached to the edge of the text box, the exact</span>
<span class="sd">            position (corners or centers) depending on where it&#39;s pointing to.</span>

<span class="sd">            **Fancy arrow:**</span>

<span class="sd">            This is used if &#39;arrowstyle&#39; is provided in the *arrowprops*.</span>

<span class="sd">            Valid keys are the following `~matplotlib.patches.FancyArrowPatch`</span>
<span class="sd">            parameters:</span>

<span class="sd">            ===============  ==================================================</span>
<span class="sd">            Key              Description</span>
<span class="sd">            ===============  ==================================================</span>
<span class="sd">            arrowstyle       the arrow style</span>
<span class="sd">            connectionstyle  the connection style</span>
<span class="sd">            relpos           see below; default is (0.5, 0.5)</span>
<span class="sd">            patchA           default is bounding box of the text</span>
<span class="sd">            patchB           default is None</span>
<span class="sd">            shrinkA          default is 2 points</span>
<span class="sd">            shrinkB          default is 2 points</span>
<span class="sd">            mutation_scale   default is text size (in points)</span>
<span class="sd">            mutation_aspect  default is 1.</span>
<span class="sd">            ?                any key for :class:`matplotlib.patches.PathPatch`</span>
<span class="sd">            ===============  ==================================================</span>

<span class="sd">            The exact starting point position of the arrow is defined by</span>
<span class="sd">            *relpos*. It&#39;s a tuple of relative coordinates of the text box,</span>
<span class="sd">            where (0, 0) is the lower left corner and (1, 1) is the upper</span>
<span class="sd">            right corner. Values &lt;0 and &gt;1 are supported and specify points</span>
<span class="sd">            outside the text box. By default (0.5, 0.5) the starting point is</span>
<span class="sd">            centered in the text box.</span>

<span class="sd">        annotation_clip : bool or None, default: None</span>
<span class="sd">            Whether to clip (i.e. not draw) the annotation when the annotation</span>
<span class="sd">            point *xy* is outside the axes area.</span>

<span class="sd">            - If *True*, the annotation will be clipped when *xy* is outside</span>
<span class="sd">              the axes.</span>
<span class="sd">            - If *False*, the annotation will always be drawn.</span>
<span class="sd">            - If *None*, the annotation will be clipped when *xy* is outside</span>
<span class="sd">              the axes and *xycoords* is &#39;data&#39;.</span>

<span class="sd">        **kwargs</span>
<span class="sd">            Additional kwargs are passed to `~matplotlib.text.Text`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `.Annotation`</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :ref:`plotting-guide-annotation`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_AnnotationBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                 <span class="n">xy</span><span class="p">,</span>
                                 <span class="n">xycoords</span><span class="o">=</span><span class="n">xycoords</span><span class="p">,</span>
                                 <span class="n">annotation_clip</span><span class="o">=</span><span class="n">annotation_clip</span><span class="p">)</span>
        <span class="c1"># warn about wonky input data</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">xytext</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="n">textcoords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="n">textcoords</span> <span class="o">!=</span> <span class="n">xycoords</span><span class="p">):</span>
            <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span><span class="s2">&quot;You have used the `textcoords` kwarg, but &quot;</span>
                               <span class="s2">&quot;not the `xytext` kwarg.  This can lead to &quot;</span>
                               <span class="s2">&quot;surprising results.&quot;</span><span class="p">)</span>

        <span class="c1"># clean up textcoords and assign default</span>
        <span class="k">if</span> <span class="n">textcoords</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">textcoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_textcoords</span> <span class="o">=</span> <span class="n">textcoords</span>

        <span class="c1"># cleanup xytext defaults</span>
        <span class="k">if</span> <span class="n">xytext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xytext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xytext</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">arrowprops</span> <span class="o">=</span> <span class="n">arrowprops</span>
        <span class="k">if</span> <span class="n">arrowprops</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">arrowprops</span> <span class="o">=</span> <span class="n">arrowprops</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;arrowstyle&quot;</span> <span class="ow">in</span> <span class="n">arrowprops</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_arrow_relpos</span> <span class="o">=</span> <span class="n">arrowprops</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;relpos&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># modified YAArrow API to be used with FancyArrowPatch</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
                        <span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="s1">&#39;headwidth&#39;</span><span class="p">,</span> <span class="s1">&#39;headlength&#39;</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">,</span> <span class="s1">&#39;frac&#39;</span><span class="p">]:</span>
                    <span class="n">arrowprops</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="o">=</span> <span class="n">FancyArrowPatch</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">**</span><span class="n">arrowprops</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Must come last, as some kwargs may be propagated to arrow_patch.</span>
        <span class="n">Text</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Annotation.contains"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Annotation.html#smpl.plot.Annotation.contains">[docs]</a>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">inside</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_contains</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inside</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inside</span><span class="p">,</span> <span class="n">info</span>
        <span class="n">contains</span><span class="p">,</span> <span class="n">tinfo</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">in_patch</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="n">contains</span> <span class="o">=</span> <span class="n">contains</span> <span class="ow">or</span> <span class="n">in_patch</span>
        <span class="k">return</span> <span class="n">contains</span><span class="p">,</span> <span class="n">tinfo</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xycoords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xycoords</span>

    <span class="nd">@xycoords</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">xycoords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xycoords</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">is_offset</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;offset&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">xycoords</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">is_offset</span><span class="p">,</span> <span class="n">xycoords</span><span class="p">))</span>
                <span class="ow">or</span> <span class="n">is_offset</span><span class="p">(</span><span class="n">xycoords</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;xycoords cannot be an offset coordinate&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xycoords</span> <span class="o">=</span> <span class="n">xycoords</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xyann</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The text position.</span>

<span class="sd">        See also *xytext* in `.Annotation`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>

    <span class="nd">@xyann</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">xyann</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xytext</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">xytext</span><span class="p">)</span>

<div class="viewcode-block" id="Annotation.get_anncoords"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Annotation.html#smpl.plot.Annotation.get_anncoords">[docs]</a>    <span class="k">def</span> <span class="nf">get_anncoords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the coordinate system to use for `.Annotation.xyann`.</span>

<span class="sd">        See also *xycoords* in `.Annotation`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_textcoords</span></div>

<div class="viewcode-block" id="Annotation.set_anncoords"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Annotation.html#smpl.plot.Annotation.set_anncoords">[docs]</a>    <span class="k">def</span> <span class="nf">set_anncoords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the coordinate system to use for `.Annotation.xyann`.</span>

<span class="sd">        See also *xycoords* in `.Annotation`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_textcoords</span> <span class="o">=</span> <span class="n">coords</span></div>

    <span class="n">anncoords</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_anncoords</span><span class="p">,</span> <span class="n">set_anncoords</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        The coordinate system to use for `.Annotation.xyann`.&quot;&quot;&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Annotation.set_figure"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Annotation.html#smpl.plot.Annotation.set_figure">[docs]</a>    <span class="k">def</span> <span class="nf">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">Artist</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span></div>

<div class="viewcode-block" id="Annotation.update_positions"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Annotation.html#smpl.plot.Annotation.update_positions">[docs]</a>    <span class="k">def</span> <span class="nf">update_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the pixel positions of the annotation text and the arrow patch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># generate transformation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_xy_transform</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">anncoords</span><span class="p">))</span>

        <span class="n">arrowprops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrowprops</span>
        <span class="k">if</span> <span class="n">arrowprops</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>

        <span class="n">arrow_end</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_position_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>  <span class="c1"># Annotated pos.</span>

        <span class="n">ms</span> <span class="o">=</span> <span class="n">arrowprops</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mutation_scale&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_mutation_scale</span><span class="p">(</span><span class="n">ms</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;arrowstyle&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">arrowprops</span><span class="p">:</span>
            <span class="c1"># Approximately simulate the YAArrow.</span>
            <span class="n">shrink</span> <span class="o">=</span> <span class="n">arrowprops</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shrink&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">arrowprops</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">headwidth</span> <span class="o">=</span> <span class="n">arrowprops</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;headwidth&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;frac&#39;</span> <span class="ow">in</span> <span class="n">arrowprops</span><span class="p">:</span>
                <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span>
                    <span class="s2">&quot;&#39;frac&#39; option in &#39;arrowprops&#39; is no longer supported;&quot;</span>
                    <span class="s2">&quot; use &#39;headlength&#39; to set the head length in points.&quot;</span><span class="p">)</span>
            <span class="n">headlength</span> <span class="o">=</span> <span class="n">arrowprops</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;headlength&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

            <span class="c1"># NB: ms is in pts</span>
            <span class="n">stylekw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">head_length</span><span class="o">=</span><span class="n">headlength</span> <span class="o">/</span> <span class="n">ms</span><span class="p">,</span>
                           <span class="n">head_width</span><span class="o">=</span><span class="n">headwidth</span> <span class="o">/</span> <span class="n">ms</span><span class="p">,</span>
                           <span class="n">tail_width</span><span class="o">=</span><span class="n">width</span> <span class="o">/</span> <span class="n">ms</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_arrowstyle</span><span class="p">(</span><span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">stylekw</span><span class="p">)</span>

            <span class="c1"># using YAArrow style:</span>
            <span class="c1"># pick the corner of the text bbox closest to annotated point.</span>
            <span class="n">xpos</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">((</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
            <span class="n">ypos</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bbox</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">((</span><span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">relposx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="p">))</span>
            <span class="n">y</span><span class="p">,</span> <span class="n">relposy</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ypos</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">y1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arrow_relpos</span> <span class="o">=</span> <span class="p">(</span><span class="n">relposx</span><span class="p">,</span> <span class="n">relposy</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
            <span class="n">shrink_pts</span> <span class="o">=</span> <span class="n">shrink</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">shrinkA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">shrinkB</span> <span class="o">=</span> <span class="n">shrink_pts</span>

        <span class="c1"># adjust the starting point of the arrow relative to the textbox.</span>
        <span class="c1"># TODO : Rotation needs to be accounted.</span>
        <span class="n">arrow_begin</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span> <span class="o">+</span> <span class="n">bbox</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arrow_relpos</span>
        <span class="c1"># The arrow is drawn from arrow_begin to arrow_end.  It will be first</span>
        <span class="c1"># clipped by patchA and patchB.  Then it will be shrunk by shrinkA and</span>
        <span class="c1"># shrinkB (in points).  If patchA is not set, self.bbox_patch is used.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_positions</span><span class="p">(</span><span class="n">arrow_begin</span><span class="p">,</span> <span class="n">arrow_end</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;patchA&quot;</span> <span class="ow">in</span> <span class="n">arrowprops</span><span class="p">:</span>
            <span class="n">patchA</span> <span class="o">=</span> <span class="n">arrowprops</span><span class="p">[</span><span class="s2">&quot;patchA&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span><span class="p">:</span>
            <span class="n">patchA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_patch</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">patchA</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">patchA</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="n">pad</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">-</span> <span class="n">pad</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">pad</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="n">pad</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">IdentityTransform</span><span class="p">(),</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">set_patchA</span><span class="p">(</span><span class="n">patchA</span><span class="p">)</span></div>

<div class="viewcode-block" id="Annotation.draw"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Annotation.html#smpl.plot.Annotation.draw">[docs]</a>    <span class="nd">@artist</span><span class="o">.</span><span class="n">allow_rasterization</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="n">renderer</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="c1"># Update text positions before `Text.draw` would, so that the</span>
        <span class="c1"># FancyArrowPatch is correctly positioned.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_positions</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_bbox_position_size</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># FancyArrowPatch</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">figure</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="c1"># Draw text, including FancyBboxPatch, after FancyArrowPatch.</span>
        <span class="c1"># Otherwise, a wedge arrowstyle can land partly on top of the Bbox.</span>
        <span class="n">Text</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span></div>

<div class="viewcode-block" id="Annotation.get_window_extent"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Annotation.html#smpl.plot.Annotation.get_window_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="c1"># This block is the same as in Text.get_window_extent, but we need to</span>
        <span class="c1"># set the renderer before calling update_positions().</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="n">renderer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">_get_renderer</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Cannot get window extent w/o renderer&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_positions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span><span class="p">)</span>

        <span class="n">text_bbox</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[</span><span class="n">text_bbox</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bboxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_patch</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">bboxes</span><span class="p">)</span></div>

<div class="viewcode-block" id="Annotation.get_tightbbox"><a class="viewcode-back" href="../../_autosummary/smpl.plot.Annotation.html#smpl.plot.Annotation.get_tightbbox">[docs]</a>    <span class="k">def</span> <span class="nf">get_tightbbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">null</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span></div></div>


<span class="n">_docstring</span><span class="o">.</span><span class="n">interpd</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Annotation</span><span class="o">=</span><span class="n">Annotation</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Alexander Puck Neuwirth.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>